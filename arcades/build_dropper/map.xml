<map proto="1.4.2" game="Arenas Cleared">
<name>Build: Dropper</name>
<version>1.1.1</version>
<objective>Build your own dropper puzzle then race everyone else!</objective>
<authors>
     <author uuid="f690a591-348b-482e-a18d-7779d0c0a28c" /> <!-- mitchiii_ -->
</authors>
<gamemode>arcade</gamemode>
<rules>
    <rule>Senior staff can expand team sizes infinitely if desired</rule>
</rules>
<teams>
   <team id="player-1" color="red"          max="1" max-overfill="1">Red</team>
   <team id="player-2" color="blue"         max="1" max-overfill="1">Blue</team>
   <team id="player-3" color="dark green"   max="1" max-overfill="1">Green</team>
   <team id="player-4" color="gold"         max="1" max-overfill="1">Orange</team>
   <team id="player-5" color="dark purple"  max="1" max-overfill="1">Purple</team>
   <team id="player-6" color="dark aqua"    max="1" max-overfill="1">Cyan</team>
   <team id="player-7" color="light purple" max="1" max-overfill="1">Pink</team>
   <team id="player-8" color="yellow"       max="1" max-overfill="1">Yellow</team>
</teams>
<blitz>
    <lives>999</lives>
    <broadcastLives>false</broadcastLives>
</blitz>
<score>
    <limit>8</limit>
    <box region="arena-1-end" filter="allow-arena-1-score" points="1" />
    <box region="arena-2-end" filter="allow-arena-2-score" points="1" />
    <box region="arena-3-end" filter="allow-arena-3-score" points="1" />
    <box region="arena-4-end" filter="allow-arena-4-score" points="1" />
    <box region="arena-5-end" filter="allow-arena-5-score" points="1" />
    <box region="arena-6-end" filter="allow-arena-6-score" points="1" />
    <box region="arena-7-end" filter="allow-arena-7-score" points="1" />
    <box region="arena-8-end" filter="race-phase"          points="1" />
    <box region="race-finish" filter="race-phase"          points="8" />
</score>
<time show="false">18m</time>
<respawn auto="true" spectate="true" freeze="0s" />
<broadcasts>
    <alert after="0s"  >Build a dropper puzzle from the top to bottom!</alert>
    <tip   after="3s"  >Double tap space to fly to assist you while building!</tip>
    <tip   after="23s" >You will have to beat your own dropper puzzle later, so don't make it too hard!</tip>
    <tip   after="83s" >Return to the start platform to restock on building materials!</tip>
    <alert after="5m"  >Complete your dropper puzzle for it to included in the race!</alert>
    <alert after="7m5s">The dropper race has begun!</alert>
    <alert after="7m" filter="arena-1-inactive">`c`lRed`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-2-inactive">`9`lBlue`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-3-inactive">`2`lGreen`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-4-inactive">`6`lOrange`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-5-inactive">`5`lPurple`r`c'sdropper puzzler has been removed from the race!</alert>
    <alert after="7m" filter="arena-6-inactive">`3`lCyan`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-7-inactive">`d`lPink`r`c's dropper puzzle has been removed from the race!</alert>
    <alert after="7m" filter="arena-8-inactive">`e`lYellow`r`c's dropper puzzle has been removed from the race!</alert>
</broadcasts>
<kits>
    <kit id="observer-kit"><effect>night vision</effect></kit>
    <!-- Main building kit -->
    <give kit="build-kit" filter="build-spawn-kit"/>
    <kit id="build-kit">
        <game-mode>adventure</game-mode>
        <item slot="3" amount="64" material="spruce fence" lore="`r`5Renewable" />
        <item slot="4" amount="64" material="wood door"    lore="`r`5Renewable" />
        <item slot="5" amount="64" material="end rod"      lore="`r`5Renewable" />
        <item slot="6" amount="64" material="web"          lore="`r`5Renewable" />
        <item slot="7"             material="iron helmet"        name="`r`bLoad Dropper Template" locked="true" lore="`r`9`lEquip to activate|`r`7Generates a pre-designed|`r`7dropper puzzle template" />
        <item slot="8"             material="diamond pickaxe"    name="`r`bMagic Pickaxe"         locked="true" unbreakable="true" />
        <chestplate                material="gold nugget"        name="`rmagic_multitool.pickaxe" locked="true"  />
        <effect duration="oo" amplifier="127">fast digging</effect>
        <fly flying="true" />
    </kit>
    <kit id="build-kit-renewable">
        <item amount="64" material="spruce fence" lore="`r`5Renewable" />
        <item amount="64" material="wood door"    lore="`r`5Renewable" />
        <item amount="64" material="end rod"      lore="`r`5Renewable" />
        <item amount="64" material="web"          lore="`r`5Renewable" />
        <game-mode>adventure</game-mode>
        <fly flying="true" />
    </kit>
    <!-- Red building blocks -->
    <kit id="build-kit-player-1">
        <item slot="0" amount="64" material="stained clay"  damage="14" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="14" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="14" lore="`r`5Renewable" />
        <boots unbreakable="true" color="993333" locked="true" material="leather boots" />
    </kit>
    <!-- Blue building blocks -->
    <kit id="build-kit-player-2">
        <item slot="0" amount="64" material="stained clay"  damage="11" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="11" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="11" lore="`r`5Renewable" />
        <boots unbreakable="true" color="334cb2" locked="true" material="leather boots" />
    </kit>
    <!-- Green building blocks -->
    <kit id="build-kit-player-3">
        <item slot="0" amount="64" material="stained clay"  damage="13" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="13" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="13" lore="`r`5Renewable" />
        <boots unbreakable="true" color="667f33" locked="true" material="leather boots" />
    </kit>
    <!-- Orange building blocks -->
    <kit id="build-kit-player-4">
        <item slot="0" amount="64" material="stained clay"  damage="1" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="1" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="1" lore="`r`5Renewable" />
        <boots unbreakable="true" color="d87f33" locked="true" material="leather boots" />
    </kit>
    <!-- Purple building blocks -->
    <kit id="build-kit-player-5">
        <item slot="0" amount="64" material="stained clay"  damage="10" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="10" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="10" lore="`r`5Renewable" />
        <boots unbreakable="true" color="7f3fb2" locked="true" material="leather boots" />
    </kit>
    <!-- Cyan building blocks -->
    <kit id="build-kit-player-6">
        <item slot="0" amount="64" material="stained clay"  damage="9" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="9" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="9" lore="`r`5Renewable" />
        <boots unbreakable="true" color="4c7f99" locked="true" material="leather boots" />
    </kit>
    <!-- Pink building blocks -->
    <kit id="build-kit-player-7">
        <item slot="0" amount="64" material="stained clay"  damage="6" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="6" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="6" lore="`r`5Renewable" />
        <boots unbreakable="true" color="f27fa5" locked="true" material="leather boots" />
    </kit>
    <!-- Yellow building blocks -->
    <kit id="build-kit-player-8">
        <item slot="0" amount="64" material="stained clay"  damage="4" lore="`r`5Renewable" />
        <item slot="1" amount="64" material="stained clay"  damage="4" lore="`r`5Renewable" />
        <item slot="2" amount="64" material="stained glass" damage="4" lore="`r`5Renewable" />
        <boots unbreakable="true" color="e5e533" locked="true" material="leather boots" />
    </kit>
    <!-- Multitool kits -->
    <kit id="multitool-pickaxe" force="true">
        <item slot="8" material="diamond pickaxe" locked="true" name="`r`bMagic Pickaxe" unbreakable="true" />
        <chestplate    material="gold nugget"     locked="true" name="`rmagic_multitool.pickaxe" />
    </kit>
    <kit id="multitool-axe" force="true">
        <item slot="8" material="diamond axe"     locked="true" name="`r`bMagic Axe" unbreakable="true" />
        <chestplate    material="gold nugget"     locked="true" name="`rmagic_multitool.axe" />
    </kit>
    <kit id="multitool-spade" force="true">
        <item slot="8" material="diamond spade"   locked="true" name="`r`bMagic Shovel" unbreakable="true" />
        <chestplate    material="gold nugget"     locked="true" name="`rmagic_multitool.spade" />
    </kit>
    <kit id="multitool-shears" force="true">
        <item slot="8" material="shears"          locked="true" name="`r`bMagic Shears" unbreakable="true" />
        <chestplate    material="gold nugget"     locked="true" name="`rmagic_multitool.shears" />
    </kit>
    <!-- Reaplly invis and blindness -->
    <give kit="arena-restart" filter="not-carrying-restart-potion"/>
    <kit id="arena-restart">
        <item slot="6" locked="true" material="potion" name="`r`cRestart Current Puzzle">
            <effect amplifier="50">harm</effect>
        </item>
    </kit>
    <!-- Clear items during testing, apply game-mode kit -->
    <kit id="clear-items" force="true" parents="race-game-mode">
        <helmet material="air" />
        <fly can-fly="false" flying="false" />
        <clear-items />
    </kit>
    <give kit="test-phase-kit" filter="build-phase-end"/>
    <kit id="test-phase-kit" force="true" parents="clear-items, arena-restart">
        <chestplate material="air" />
    </kit>
    <!-- Set players to adventure mode for racing -->
    <kit id="race-game-mode" force="true">
        <game-mode>adventure</game-mode>
        <max-health>2</max-health>
    </kit>
    <!-- Druing race blindness and invis -->
    <kit id="race-effects" force="true" parents="race-game-mode">
        <effect duration="1">blindness</effect>
        <effect>invisibility</effect>
        <clear-items />
    </kit>
    <!-- Arena Keys -->
    <give kit="arena-1-key" filter="inside-arena-1-during-race" />
    <kit id="arena-1-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="00684a88-5cc8-4713-9e91-7b1906e67580" name="`r`bCurrent Arena: `c1" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvNzFiYzJiY2ZiMmJkMzc1OWU2YjFlODZmYzdhNzk1ODVlMTEyN2RkMzU3ZmMyMDI4OTNmOWRlMjQxYmM5ZTUzMCJ9fX0=</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_1" locked="true" />
    </kit>
    <give kit="arena-2-key" filter="inside-arena-2-during-race" />
    <kit id="arena-2-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="f7218833-aceb-4d3e-a1bc-a334be09c375" name="`r`bCurrent Arena: `92" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvNGNkOWVlZWU4ODM0Njg4ODFkODM4NDhhNDZiZjMwMTI0ODVjMjNmNzU3NTNiOGZiZTg0ODczNDE0MTk4NDcifX19</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_2" locked="true" />
    </kit>
    <give kit="arena-3-key" filter="inside-arena-3-during-race" />
    <kit id="arena-3-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="870c6ce6-78b5-4e09-8745-bd96d616e516" name="`r`bCurrent Arena: `23" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvMWQ0ZWFlMTM5MzM4NjBhNmRmNWU4ZTk1NTY5M2I5NWE4YzNiMTVjMzZiOGI1ODc1MzJhYzA5OTZiYzM3ZTUifX19</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_3" locked="true" />
    </kit>
    <give kit="arena-4-key" filter="inside-arena-4-during-race" />
    <kit id="arena-4-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="d531b607-3d92-4760-b19f-b64d51da0fa5" name="`r`bCurrent Arena: `64" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvZDJlNzhmYjIyNDI0MjMyZGMyN2I4MWZiY2I0N2ZkMjRjMWFjZjc2MDk4NzUzZjJkOWMyODU5ODI4N2RiNSJ9fX0=</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_4" locked="true" />
    </kit>
    <give kit="arena-5-key" filter="inside-arena-5-during-race" />
    <kit id="arena-5-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="4aaa0af9-ffde-4f5a-ad06-112dffbade0c" name="`r`bCurrent Arena: `55" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvNmQ1N2UzYmM4OGE2NTczMGUzMWExNGUzZjQxZTAzOGE1ZWNmMDg5MWE2YzI0MzY0M2I4ZTU0NzZhZTIifX19</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_5" locked="true" />
    </kit>
    <give kit="arena-6-key" filter="inside-arena-6-during-race" />
    <kit id="arena-6-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="58a05887-3473-4c87-8506-2acf877d7ff1" name="`r`bCurrent Arena: `36" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvMzM0YjM2ZGU3ZDY3OWI4YmJjNzI1NDk5YWRhZWYyNGRjNTE4ZjVhZTIzZTcxNjk4MWUxZGNjNmIyNzIwYWIifX19</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_6" locked="true" />
    </kit>
    <give kit="arena-7-key" filter="inside-arena-7-during-race" />
    <kit id="arena-7-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="23378bd2-28e5-4d7e-8d39-621b732e1f49" name="`r`bCurrent Arena: `d7" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvNmRiNmViMjVkMWZhYWJlMzBjZjQ0NGRjNjMzYjU4MzI0NzVlMzgwOTZiN2UyNDAyYTNlYzQ3NmRkN2I5In19fQ==</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_7" locked="true" />
    </kit>
    <give kit="arena-8-key" filter="inside-arena-8-during-race" />
    <kit id="arena-8-key" force="true">
        <item slot="2" material="skull item" damage="3" uuid="19c144be-a435-42a4-9503-83bcd8a7fa70" name="`r`bCurrent Arena: `e8" locked="true">
            <skin>eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvNTkxOTQ5NzNhM2YxN2JkYTk5NzhlZDYyNzMzODM5OTcyMjI3NzRiNDU0Mzg2YzgzMTljMDRmMWY0Zjc0YzJiNSJ9fX0=</skin>
        </item>
        <item slot="slot.armor.chest" material="name tag" name="return_arena_8" locked="true" />
    </kit>
    <!-- Disable slot where preset key once was -->
    <give kit="disable-preset" filter="player-1-preset" />
    <give kit="disable-preset" filter="player-2-preset" />
    <give kit="disable-preset" filter="player-3-preset" />
    <give kit="disable-preset" filter="player-4-preset" />
    <give kit="disable-preset" filter="player-5-preset" />
    <give kit="disable-preset" filter="player-6-preset" />
    <give kit="disable-preset" filter="player-7-preset" />
    <give kit="disable-preset" filter="player-8-preset" />
    <kit id="disable-preset" force="true">
        <item slot="7" material="barrier" name="`aDropper template loaded" locked="true" lore="`r`c`lYou have already loaded the template!" />
        <helmet material="air" />
    </kit>
</kits>
<item-mods>
    <rule>
        <match>
            <all-blocks/>
            <material>iron door</material>
            <material>wood door</material>
            <material>sign</material>
            <material>cake</material>
        </match>
        <modify show-can-destroy="false" show-can-place-on="false">
            <can-destroy><all-blocks/></can-destroy>
            <can-place-on><all-blocks/></can-place-on>
        </modify>
    </rule>
    <rule>
        <match>
            <material>diamond pickaxe</material>
            <material>diamond axe</material>
            <material>diamond spade</material>
            <material>shears</material>
        </match>
        <modify show-can-destroy="false" show-attributes="false" show-unbreakable="false">
            <can-destroy><all-blocks/></can-destroy>
        </modify>
    </rule>
</item-mods>
<filters>
    <!-- Deny players from consuming or opening inventories of blocks -->
    <not id="you-are-not-allowed-to-eat-the-cake">
        <any>
            <material>cake block</material>
            <material>anvil</material>
            <material>hopper</material>
            <material>dispenser</material>
        </any>
    </not>
    <!-- Check which arena token player is carrying -->
    <carrying id="allow-arena-1-enter">
        <item material="name tag" name="return_arena_1" locked="true" />
    </carrying>
    <carrying id="allow-arena-2-enter">
        <item material="name tag" name="return_arena_2" locked="true" />
    </carrying>
    <carrying id="allow-arena-3-enter">
        <item material="name tag" name="return_arena_3" locked="true" />
    </carrying>
    <carrying id="allow-arena-4-enter">
        <item material="name tag" name="return_arena_4" locked="true" />
    </carrying>
    <carrying id="allow-arena-5-enter">
        <item material="name tag" name="return_arena_5" locked="true" />
    </carrying>
    <carrying id="allow-arena-6-enter">
        <item material="name tag" name="return_arena_6" locked="true" />
    </carrying>
    <carrying id="allow-arena-7-enter">
        <item material="name tag" name="return_arena_7" locked="true" />
    </carrying>
    <carrying id="allow-arena-8-enter">
        <item material="name tag" name="return_arena_8" locked="true" />
    </carrying>
    <!-- Check if player is requesting preset puzzle -->
    <wearing id="preset-puzzle-request">
        <item material="iron helmet" name="`r`bLoad Dropper Template" lore="`r`9`lEquip to activate|`r`7Generates a pre-designed|`r`7dropper puzzle template" />
    </wearing>
    <all id="player-1-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-1" /></all>
    <all id="player-2-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-2" /></all>
    <all id="player-3-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-3" /></all>
    <all id="player-4-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-4" /></all>
    <all id="player-5-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-5" /></all>
    <all id="player-6-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-6" /></all>
    <all id="player-7-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-7" /></all>
    <all id="player-8-preset-puzzle-request"><filter id="preset-puzzle-request" /><filter id="during-build-phase-player-8" /></all>
    <!-- Check if player used preset puzzle -->
    <all id="player-1-preset">
        <objective id="arena-1-preset-active" any="true">arena-1-preset</objective>
        <filter id="during-build-phase-player-1" />
    </all>
    <all id="player-2-preset">
        <objective id="arena-2-preset-active" any="true">arena-2-preset</objective>
        <filter id="during-build-phase-player-2" />
    </all>
    <all id="player-3-preset">
        <objective id="arena-3-preset-active" any="true">arena-3-preset</objective>
        <filter id="during-build-phase-player-3" />
    </all>
    <all id="player-4-preset">
        <objective id="arena-4-preset-active" any="true">arena-4-preset</objective>
        <filter id="during-build-phase-player-4" />
    </all>
    <all id="player-5-preset">
        <objective id="arena-5-preset-active" any="true">arena-5-preset</objective>
        <filter id="during-build-phase-player-5" />
    </all>
    <all id="player-6-preset">
        <objective id="arena-6-preset-active" any="true">arena-6-preset</objective>
        <filter id="during-build-phase-player-6" />
    </all>
    <all id="player-7-preset">
        <objective id="arena-7-preset-active" any="true">arena-7-preset</objective>
        <filter id="during-build-phase-player-7" />
    </all>
    <all id="player-8-preset">
        <objective id="arena-8-preset-active" any="true">arena-8-preset</objective>
        <filter id="during-build-phase-player-8" />
    </all>
    <!-- Player filters -->
    <team id="only-player-1">player-1</team>
    <team id="only-player-2">player-2</team>
    <team id="only-player-3">player-3</team>
    <team id="only-player-4">player-4</team>
    <team id="only-player-5">player-5</team>
    <team id="only-player-6">player-6</team>
    <team id="only-player-7">player-7</team>
    <team id="only-player-8">player-8</team>
    <!-- Filter specific players during the build phase -->
    <all id="during-build-phase-player-1"><filter id="only-player-1" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-2"><filter id="only-player-2" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-3"><filter id="only-player-3" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-4"><filter id="only-player-4" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-5"><filter id="only-player-5" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-6"><filter id="only-player-6" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-7"><filter id="only-player-7" /><filter id="build-phase" /></all>
    <all id="during-build-phase-player-8"><filter id="only-player-8" /><filter id="build-phase" /></all>
    <!-- Filter specific players during the test phase -->
    <all id="during-test-phase-player-1"><filter id="only-player-1" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-2"><filter id="only-player-2" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-3"><filter id="only-player-3" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-4"><filter id="only-player-4" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-5"><filter id="only-player-5" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-6"><filter id="only-player-6" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-7"><filter id="only-player-7" /><filter id="testing-phase" /></all>
    <all id="during-test-phase-player-8"><filter id="only-player-8" /><filter id="testing-phase" /></all>
    <!-- Filter specific players during the race phase -->
    <all id="during-race-phase-player-1"><filter id="only-player-1" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-2"><filter id="only-player-2" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-3"><filter id="only-player-3" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-4"><filter id="only-player-4" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-5"><filter id="only-player-5" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-6"><filter id="only-player-6" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-7"><filter id="only-player-7" /><filter id="race-phase" /></all>
    <all id="during-race-phase-player-8"><filter id="only-player-8" /><filter id="race-phase" /></all>
    <!-- Check if player is carrying a damage potion or not -->
    <all id="not-carrying-restart-potion">
        <region id="all-arenas-whole" />
        <filter id="after-test-phase-start" />
        <participating />
    </all>
    <!-- Check if players are allowed to score at arena end points -->
    <any id="allow-arena-1-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-1-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-1-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-1-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-1-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-1-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-1-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-1-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-1-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-2-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-2-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-2-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-2-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-2-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-2-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-2-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-2-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-2-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-3-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-3-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-3-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-3-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-3-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-3-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-3-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-3-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-3-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-4-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-4-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-4-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-4-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-4-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-4-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-4-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-4-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-4-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-5-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-5-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-5-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-5-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-5-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-5-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-5-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-5-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-5-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-6-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-6-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-6-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-6-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-6-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-6-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-6-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-6-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-6-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <any id="allow-arena-7-score">
        <all><filter id="only-player-1" /><not><objective any="true">arena-7-passed-player-1</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-2" /><not><objective any="true">arena-7-passed-player-2</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-3" /><not><objective any="true">arena-7-passed-player-3</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-4" /><not><objective any="true">arena-7-passed-player-4</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-5" /><not><objective any="true">arena-7-passed-player-5</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-6" /><not><objective any="true">arena-7-passed-player-6</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-7" /><not><objective any="true">arena-7-passed-player-7</objective></not><filter id="race-phase" /></all>
        <all><filter id="only-player-8" /><not><objective any="true">arena-7-passed-player-8</objective></not><filter id="race-phase" /></all>
    </any>
    <!-- Deny natural block changes -->
    <not id="deny-natural-block-changes">
        <all>
            <cause>world</cause>
            <any>
                <material>ice</material>
                <material>vine</material>
            </any>
        </all>
    </not>
    <!-- Blocks which can be placed or broken by the player -->
    <any id="placeable-blocks">
        <material>stained clay</material>
        <material>stained glass</material>
        <material>spruce fence</material>
        <material>wooden door</material>
        <material>end rod</material>
        <material>web</material>
        <material>sign</material>
    </any>
    <!-- Check if arena has been completed during testing, then enable or disable it during the race phase -->
    <not id="arena-1-inactive"><objective id="arena-1-active" any="true">arena-1-completed</objective></not>
    <not id="arena-2-inactive"><objective id="arena-2-active" any="true">arena-2-completed</objective></not>
    <not id="arena-3-inactive"><objective id="arena-3-active" any="true">arena-3-completed</objective></not>
    <not id="arena-4-inactive"><objective id="arena-4-active" any="true">arena-4-completed</objective></not>
    <not id="arena-5-inactive"><objective id="arena-5-active" any="true">arena-5-completed</objective></not>
    <not id="arena-6-inactive"><objective id="arena-6-active" any="true">arena-6-completed</objective></not>
    <not id="arena-7-inactive"><objective id="arena-7-active" any="true">arena-7-completed</objective></not>
    <not id="arena-8-inactive"><objective id="arena-8-active" any="true">arena-8-completed</objective></not>
    <!-- Trigger filters, save teammates if testing has been completed by another teammate -->
    <all id="save-teammates-1-if-testing-complete"><filter id="arena-1-active" /><filter id="only-player-1" /><filter id="testing-phase" /><region id="arena-1" /></all>
    <all id="save-teammates-2-if-testing-complete"><filter id="arena-2-active" /><filter id="only-player-2" /><filter id="testing-phase" /><region id="arena-2" /></all>
    <all id="save-teammates-3-if-testing-complete"><filter id="arena-3-active" /><filter id="only-player-3" /><filter id="testing-phase" /><region id="arena-3" /></all>
    <all id="save-teammates-4-if-testing-complete"><filter id="arena-4-active" /><filter id="only-player-4" /><filter id="testing-phase" /><region id="arena-4" /></all>
    <all id="save-teammates-5-if-testing-complete"><filter id="arena-5-active" /><filter id="only-player-5" /><filter id="testing-phase" /><region id="arena-5" /></all>
    <all id="save-teammates-6-if-testing-complete"><filter id="arena-6-active" /><filter id="only-player-6" /><filter id="testing-phase" /><region id="arena-6" /></all>
    <all id="save-teammates-7-if-testing-complete"><filter id="arena-7-active" /><filter id="only-player-7" /><filter id="testing-phase" /><region id="arena-7" /></all>
    <all id="save-teammates-8-if-testing-complete"><filter id="arena-8-active" /><filter id="only-player-8" /><filter id="testing-phase" /><region id="arena-8" /></all>
    <!-- Phase times -->
    <all id="build-spawn-kit"  ><not><time>6s</time></not><region id="all-arenas-whole" /><participating /></all>
    <all id="build-phase"      ><time>0s</time><not><time>5m</time></not></all>
    <all id="build-phase-end"  ><time>5m</time><not><time>5m1s</time></not><region id="all-arenas-whole" /></all>
    <all id="testing-phase"    ><time id="after-test-phase-start">5m</time><not><time>7m</time></not></all>
    <all id="testing-phase-end"><time>7m</time><not><time>7m1s</time></not><region id="all-arenas-whole" /></all>
    <all id="race-started"     ><time id="race-phase">7m5s</time><not><time>7m6s</time></not></all>
    <!-- Trigger filters, build phase ended -->
    <all id="arena-1-build-phase-end"><filter id="only-player-1" /><filter id="build-phase-end" /><region id="arena-1" /></all>
    <all id="arena-2-build-phase-end"><filter id="only-player-2" /><filter id="build-phase-end" /><region id="arena-2" /></all>
    <all id="arena-3-build-phase-end"><filter id="only-player-3" /><filter id="build-phase-end" /><region id="arena-3" /></all>
    <all id="arena-4-build-phase-end"><filter id="only-player-4" /><filter id="build-phase-end" /><region id="arena-4" /></all>
    <all id="arena-5-build-phase-end"><filter id="only-player-5" /><filter id="build-phase-end" /><region id="arena-5" /></all>
    <all id="arena-6-build-phase-end"><filter id="only-player-6" /><filter id="build-phase-end" /><region id="arena-6" /></all>
    <all id="arena-7-build-phase-end"><filter id="only-player-7" /><filter id="build-phase-end" /><region id="arena-7" /></all>
    <all id="arena-8-build-phase-end"><filter id="only-player-8" /><filter id="build-phase-end" /><region id="arena-8" /></all>
    <!-- Trigger filters, testing phase ended -->
    <all id="arena-0-testing-phase-end"><filter id="testing-phase-end" /><region id="all-arenas-whole" /></all>
    <!-- Trigger filters, race started -->
    <all id="arena-0-race-started"><filter id="race-started" /><region id="arena-0" /></all>
    <!-- Teleport players back to the arena start during build phase when they sneak while in build net -->
    <all id="arena-1-build-net-active"><region id="arena-1-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-2-build-net-active"><region id="arena-2-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-3-build-net-active"><region id="arena-3-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-4-build-net-active"><region id="arena-4-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-5-build-net-active"><region id="arena-5-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-6-build-net-active"><region id="arena-6-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-7-build-net-active"><region id="arena-7-end" /><filter id="build-phase" /><crouching /></all>
    <all id="arena-8-build-net-active"><region id="arena-8-end" /><filter id="build-phase" /><crouching /></all>
    <!-- Check what arena player is inside during race phase -->
    <all id="inside-arena-1-during-race"><region id="arena-1" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-2-during-race"><region id="arena-2" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-3-during-race"><region id="arena-3" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-4-during-race"><region id="arena-4" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-5-during-race"><region id="arena-5" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-6-during-race"><region id="arena-6" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-7-during-race"><region id="arena-7" /><filter id="race-phase" /><participating /></all>
    <all id="inside-arena-8-during-race"><region id="arena-8" /><filter id="race-phase" /><participating /></all>
    <!-- Phase group countdowns -->
    <countdown duration="5m" message="Building phase ends in {0}">
        <all>
            <not>
                <time>5m</time>
            </not>
            <match-running/>
        </all>
    </countdown>
    <countdown duration="2m" message="Testing phase ends in {0}">
        <all>
            <time>5m</time>
            <not>
                <time>7m</time>
            </not>
            <match-running/>
        </all>
    </countdown>
    <countdown duration="5s" message="The race will begin in {0}">
        <all>
            <time>7m</time>
            <not>
                <time>7m5s</time>
            </not>
            <match-running/>
        </all>
    </countdown>
    <countdown duration="1m" message="The player with the most points will win in {0}">
        <all>
            <time>17m</time>
            <match-running/>
        </all>
    </countdown>
</filters>
<regions>
    <!-- Apply invis and blindness each time player enters a new tube -->
    <apply region="arena-1-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-2-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-3-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-4-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-5-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-6-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-7-tube-award" kit="race-effects" filter="race-phase" />
    <apply region="arena-8-tube-award" kit="race-effects" filter="race-phase" />
    <!-- Start platforms -->
    <union id="start-union">
        <cuboid    id="arena-1-start-prot" min="116,57,2" max="119,71,9" />
        <translate id="arena-2-start-prot" offset="0,0,-34"><region id="arena-1-start-prot" /></translate>
        <translate id="arena-3-start-prot" offset="0,0,-34"><region id="arena-2-start-prot" /></translate>
        <translate id="arena-4-start-prot" offset="0,0,-34"><region id="arena-3-start-prot" /></translate>
        <translate id="arena-5-start-prot" offset="0,0,-34"><region id="arena-4-start-prot" /></translate>
        <translate id="arena-6-start-prot" offset="0,0,-34"><region id="arena-5-start-prot" /></translate>
        <translate id="arena-7-start-prot" offset="0,0,-34"><region id="arena-6-start-prot" /></translate>
        <translate id="arena-8-start-prot" offset="0,0,-34"><region id="arena-7-start-prot" /></translate>
    </union>
    <apply block="never" message="You may not interact with that material here">
        <region>
            <above y="71" />
            <below y="5" />
        </region>
    </apply>
    <apply block="placeable-blocks" message="You may not interact with that material here">
        <region>
            <intersect>
                <below y="71" />
                <above y="5" />
            </intersect>
        </region>
    </apply>
    <apply use="you-are-not-allowed-to-eat-the-cake" />
    <!-- Deny movement outside arenas -->
    <apply enter="never" message="You may not leave this arena!">
        <region>
            <negative>
                <union>
                    <region id="all-arenas-whole" />
                    <region id="arena-0" />
                    <below x="95" />
                </union>
            </negative>
            <above y="86" />
        </region>
    </apply>
    <!-- Lobby enterance point -->
    <block    id="lobby-point">104.5,78,38.5</block>
    <!-- Remove any items the player may have from testing phase -->
    <cylinder id="lobby-kit-apply" base="104.5,76,38.5" radius="6" height="1" />
    <apply kit="clear-items" region="lobby-kit-apply" />
    <!-- Arena starting points -->
    <block     id="race-finish"  >104.5,78,38.5</block>
    <point     id="arena-1-start">104.5,76,4.5</point><!-- 34 block difference between rooms -->
    <translate id="arena-2-start" offset="0,0,-34"><region id="arena-1-start" /></translate>
    <translate id="arena-3-start" offset="0,0,-34"><region id="arena-2-start" /></translate>
    <translate id="arena-4-start" offset="0,0,-34"><region id="arena-3-start" /></translate>
    <translate id="arena-5-start" offset="0,0,-34"><region id="arena-4-start" /></translate>
    <translate id="arena-6-start" offset="0,0,-34"><region id="arena-5-start" /></translate>
    <translate id="arena-7-start" offset="0,0,-34"><region id="arena-6-start" /></translate>
    <translate id="arena-8-start" offset="0,0,-34"><region id="arena-7-start" /></translate>
    <!-- Arena start portals -->
    <union id="arena-start-areas">
        <cuboid    id="arena-1-start-area" min="102,75,2" max="107,78,7" />
        <translate id="arena-2-start-area" offset="0,0,-34"><region id="arena-1-start-area" /></translate>
        <translate id="arena-3-start-area" offset="0,0,-34"><region id="arena-2-start-area" /></translate>
        <translate id="arena-4-start-area" offset="0,0,-34"><region id="arena-3-start-area" /></translate>
        <translate id="arena-5-start-area" offset="0,0,-34"><region id="arena-4-start-area" /></translate>
        <translate id="arena-6-start-area" offset="0,0,-34"><region id="arena-5-start-area" /></translate>
        <translate id="arena-7-start-area" offset="0,0,-34"><region id="arena-6-start-area" /></translate>
        <translate id="arena-8-start-area" offset="0,0,-34"><region id="arena-7-start-area" /></translate>
    </union>
    <!-- Restock player build kits when they enter thet start gate -->
    <apply kit="build-kit-player-1"  region="arena-1-start-area" filter="during-build-phase-player-1" />
    <apply kit="build-kit-player-2"  region="arena-2-start-area" filter="during-build-phase-player-2" />
    <apply kit="build-kit-player-3"  region="arena-3-start-area" filter="during-build-phase-player-3" />
    <apply kit="build-kit-player-4"  region="arena-4-start-area" filter="during-build-phase-player-4" />
    <apply kit="build-kit-player-5"  region="arena-5-start-area" filter="during-build-phase-player-5" />
    <apply kit="build-kit-player-6"  region="arena-6-start-area" filter="during-build-phase-player-6" />
    <apply kit="build-kit-player-7"  region="arena-7-start-area" filter="during-build-phase-player-7" />
    <apply kit="build-kit-player-8"  region="arena-8-start-area" filter="during-build-phase-player-8" />
    <apply kit="build-kit-renewable" region="arena-start-areas"  filter="build-phase" />
    <!-- Area bottoms -->
    <union id="arena-ends">
        <cuboid    id="arena-1-end" min="98,3,-2" max="111,4,11" />
        <translate id="arena-2-end" offset="0,0,-34"><region id="arena-1-end" /></translate>
        <translate id="arena-3-end" offset="0,0,-34"><region id="arena-2-end" /></translate>
        <translate id="arena-4-end" offset="0,0,-34"><region id="arena-3-end" /></translate>
        <translate id="arena-5-end" offset="0,0,-34"><region id="arena-4-end" /></translate>
        <translate id="arena-6-end" offset="0,0,-34"><region id="arena-5-end" /></translate>
        <translate id="arena-7-end" offset="0,0,-34"><region id="arena-6-end" /></translate>
        <translate id="arena-8-end" offset="0,0,-34"><region id="arena-7-end" /></translate>
    </union>
    <!-- Whole region coverage -->
    <rectangle id="arena-0" min="98,32" max="111,45" />
    <union id="all-arenas-whole">
        <rectangle id="arena-1" min="98,-2" max="111,11" />
        <translate id="arena-2" offset="0,0,-34"><region id="arena-1" /></translate>
        <translate id="arena-3" offset="0,0,-34"><region id="arena-2" /></translate>
        <translate id="arena-4" offset="0,0,-34"><region id="arena-3" /></translate>
        <translate id="arena-5" offset="0,0,-34"><region id="arena-4" /></translate>
        <translate id="arena-6" offset="0,0,-34"><region id="arena-5" /></translate>
        <translate id="arena-7" offset="0,0,-34"><region id="arena-6" /></translate>
        <translate id="arena-8" offset="0,0,-34"><region id="arena-7" /></translate>
    </union>
    <!-- Arena buildable area -->
    <union id="rooms-union">
        <cuboid    id="arena-1-build" min="98,4,-2" max="111,69,11" />
        <translate id="arena-2-build" offset="0,0,-34"><region id="arena-1" /></translate>
        <translate id="arena-3-build" offset="0,0,-34"><region id="arena-2" /></translate>
        <translate id="arena-4-build" offset="0,0,-34"><region id="arena-3" /></translate>
        <translate id="arena-5-build" offset="0,0,-34"><region id="arena-4" /></translate>
        <translate id="arena-6-build" offset="0,0,-34"><region id="arena-5" /></translate>
        <translate id="arena-7-build" offset="0,0,-34"><region id="arena-6" /></translate>
        <translate id="arena-8-build" offset="0,0,-34"><region id="arena-7" /></translate>
    </union>
    <!-- Arena tube enterance points -->
    <point     id="arena-1-tube-enter">92.5,4,15.5</point>
    <translate id="arena-2-tube-enter" offset="0,0,-34"><region id="arena-1-tube-enter" /></translate>
    <translate id="arena-3-tube-enter" offset="0,0,-34"><region id="arena-2-tube-enter" /></translate>
    <translate id="arena-4-tube-enter" offset="0,0,-34"><region id="arena-3-tube-enter" /></translate>
    <translate id="arena-5-tube-enter" offset="0,0,-34"><region id="arena-4-tube-enter" /></translate>
    <translate id="arena-6-tube-enter" offset="0,0,-34"><region id="arena-5-tube-enter" /></translate>
    <translate id="arena-7-tube-enter" offset="0,0,-34"><region id="arena-6-tube-enter" /></translate>
    <translate id="arena-8-tube-enter" offset="0,0,-34"><region id="arena-7-tube-enter" /></translate>
    <translate id="arena-0-tube-enter" offset="0,0,34" ><region id="arena-1-tube-enter" /></translate>
    <!-- Arena tube regions -->
    <union id="arena-end-points">
        <cuboid    id="arena-1-tube" min="91,5,14" max="94,5.5,17" />
        <translate id="arena-2-tube" offset="0,0,-34"><region id="arena-1-tube" /></translate>
        <translate id="arena-3-tube" offset="0,0,-34"><region id="arena-2-tube" /></translate>
        <translate id="arena-4-tube" offset="0,0,-34"><region id="arena-3-tube" /></translate>
        <translate id="arena-5-tube" offset="0,0,-34"><region id="arena-4-tube" /></translate>
        <translate id="arena-6-tube" offset="0,0,-34"><region id="arena-5-tube" /></translate>
        <translate id="arena-7-tube" offset="0,0,-34"><region id="arena-6-tube" /></translate>
        <translate id="arena-8-tube" offset="0,0,-34"><region id="arena-7-tube" /></translate>
        <translate id="arena-0-tube" offset="0,0,34" ><region id="arena-1-tube" /></translate>
    </union>
    <!-- Area tube award regions -->
    <translate id="arena-1-tube-award" offset="0,-1,0"><region id="arena-1-tube" /></translate>
    <translate id="arena-2-tube-award" offset="0,-1,0"><region id="arena-2-tube" /></translate>
    <translate id="arena-3-tube-award" offset="0,-1,0"><region id="arena-3-tube" /></translate>
    <translate id="arena-4-tube-award" offset="0,-1,0"><region id="arena-4-tube" /></translate>
    <translate id="arena-5-tube-award" offset="0,-1,0"><region id="arena-5-tube" /></translate>
    <translate id="arena-6-tube-award" offset="0,-1,0"><region id="arena-6-tube" /></translate>
    <translate id="arena-7-tube-award" offset="0,-1,0"><region id="arena-7-tube" /></translate>
    <translate id="arena-8-tube-award" offset="0,-1,0"><region id="arena-8-tube" /></translate>
    <!-- Arena tube portal regions -->
    <translate id="arena-1-tube-portal" offset="0,-3,0"><region id="arena-1-tube" /></translate>
    <translate id="arena-2-tube-portal" offset="0,-3,0"><region id="arena-2-tube" /></translate>
    <translate id="arena-3-tube-portal" offset="0,-3,0"><region id="arena-3-tube" /></translate>
    <translate id="arena-4-tube-portal" offset="0,-3,0"><region id="arena-4-tube" /></translate>
    <translate id="arena-5-tube-portal" offset="0,-3,0"><region id="arena-5-tube" /></translate>
    <translate id="arena-6-tube-portal" offset="0,-3,0"><region id="arena-6-tube" /></translate>
    <translate id="arena-7-tube-portal" offset="0,-3,0"><region id="arena-7-tube" /></translate>
    <translate id="arena-8-tube-portal" offset="0,-3,0"><region id="arena-8-tube" /></translate>
    <translate id="arena-0-tube-portal" offset="0,-3,0"><region id="arena-0-tube" /></translate>
    <!-- Arena tube fail-safe -->
    <translate id="arena-1-tube-fail-safe" offset="0,-5,0"><region id="arena-1-tube" /></translate>
    <translate id="arena-2-tube-fail-safe" offset="0,-5,0"><region id="arena-2-tube" /></translate>
    <translate id="arena-3-tube-fail-safe" offset="0,-5,0"><region id="arena-3-tube" /></translate>
    <translate id="arena-4-tube-fail-safe" offset="0,-5,0"><region id="arena-4-tube" /></translate>
    <translate id="arena-5-tube-fail-safe" offset="0,-5,0"><region id="arena-5-tube" /></translate>
    <translate id="arena-6-tube-fail-safe" offset="0,-5,0"><region id="arena-6-tube" /></translate>
    <translate id="arena-7-tube-fail-safe" offset="0,-5,0"><region id="arena-7-tube" /></translate>
    <translate id="arena-8-tube-fail-safe" offset="0,-5,0"><region id="arena-8-tube" /></translate>
    <translate id="arena-0-tube-fail-safe" offset="0,-5,0"><region id="arena-0-tube" /></translate>
</regions>
<control-points required="false" points="0" capture-time="0s" permanent="true" show="false">
    <!-- Check if player wants to load dropper template -->
    <control-point id="arena-1-preset" name="arena-1-preset" capture="everywhere" player-filter="player-1-preset-puzzle-request" />
    <control-point id="arena-2-preset" name="arena-2-preset" capture="everywhere" player-filter="player-2-preset-puzzle-request" />
    <control-point id="arena-3-preset" name="arena-3-preset" capture="everywhere" player-filter="player-3-preset-puzzle-request" />
    <control-point id="arena-4-preset" name="arena-4-preset" capture="everywhere" player-filter="player-4-preset-puzzle-request" />
    <control-point id="arena-5-preset" name="arena-5-preset" capture="everywhere" player-filter="player-5-preset-puzzle-request" />
    <control-point id="arena-6-preset" name="arena-6-preset" capture="everywhere" player-filter="player-6-preset-puzzle-request" />
    <control-point id="arena-7-preset" name="arena-7-preset" capture="everywhere" player-filter="player-7-preset-puzzle-request" />
    <control-point id="arena-8-preset" name="arena-8-preset" capture="everywhere" player-filter="player-8-preset-puzzle-request" />
    <!-- Check if arena is actually possible -->
    <control-point id="arena-1-completed" name="arena-1-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-1" />
    <control-point id="arena-2-completed" name="arena-2-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-2" />
    <control-point id="arena-3-completed" name="arena-3-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-3" />
    <control-point id="arena-4-completed" name="arena-4-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-4" />
    <control-point id="arena-5-completed" name="arena-5-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-5" />
    <control-point id="arena-6-completed" name="arena-6-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-6" />
    <control-point id="arena-7-completed" name="arena-7-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-7" />
    <control-point id="arena-8-completed" name="arena-8-completed" capture="lobby-kit-apply" player-filter="during-test-phase-player-8" />
    <!-- Check if team has already completed arena 
         Arena 1 -->
    <control-point id="arena-1-passed-player-1" name="arena-1-passed-player-1" capture="arena-2-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-1-passed-player-2" name="arena-1-passed-player-2" capture="arena-2-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-1-passed-player-3" name="arena-1-passed-player-3" capture="arena-2-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-1-passed-player-4" name="arena-1-passed-player-4" capture="arena-2-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-1-passed-player-5" name="arena-1-passed-player-5" capture="arena-2-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-1-passed-player-6" name="arena-1-passed-player-6" capture="arena-2-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-1-passed-player-7" name="arena-1-passed-player-7" capture="arena-2-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-1-passed-player-8" name="arena-1-passed-player-8" capture="arena-2-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 2 -->
    <control-point id="arena-2-passed-player-1" name="arena-2-passed-player-1" capture="arena-3-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-2-passed-player-2" name="arena-2-passed-player-2" capture="arena-3-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-2-passed-player-3" name="arena-2-passed-player-3" capture="arena-3-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-2-passed-player-4" name="arena-2-passed-player-4" capture="arena-3-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-2-passed-player-5" name="arena-2-passed-player-5" capture="arena-3-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-2-passed-player-6" name="arena-2-passed-player-6" capture="arena-3-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-2-passed-player-7" name="arena-2-passed-player-7" capture="arena-3-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-2-passed-player-8" name="arena-2-passed-player-8" capture="arena-3-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 3 -->
    <control-point id="arena-3-passed-player-1" name="arena-3-passed-player-1" capture="arena-4-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-3-passed-player-2" name="arena-3-passed-player-2" capture="arena-4-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-3-passed-player-3" name="arena-3-passed-player-3" capture="arena-4-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-3-passed-player-4" name="arena-3-passed-player-4" capture="arena-4-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-3-passed-player-5" name="arena-3-passed-player-5" capture="arena-4-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-3-passed-player-6" name="arena-3-passed-player-6" capture="arena-4-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-3-passed-player-7" name="arena-3-passed-player-7" capture="arena-4-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-3-passed-player-8" name="arena-3-passed-player-8" capture="arena-4-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 4 -->
    <control-point id="arena-4-passed-player-1" name="arena-4-passed-player-1" capture="arena-5-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-4-passed-player-2" name="arena-4-passed-player-2" capture="arena-5-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-4-passed-player-3" name="arena-4-passed-player-3" capture="arena-5-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-4-passed-player-4" name="arena-4-passed-player-4" capture="arena-5-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-4-passed-player-5" name="arena-4-passed-player-5" capture="arena-5-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-4-passed-player-6" name="arena-4-passed-player-6" capture="arena-5-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-4-passed-player-7" name="arena-4-passed-player-7" capture="arena-5-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-4-passed-player-8" name="arena-4-passed-player-8" capture="arena-5-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 5 -->
    <control-point id="arena-5-passed-player-1" name="arena-5-passed-player-1" capture="arena-6-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-5-passed-player-2" name="arena-5-passed-player-2" capture="arena-6-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-5-passed-player-3" name="arena-5-passed-player-3" capture="arena-6-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-5-passed-player-4" name="arena-5-passed-player-4" capture="arena-6-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-5-passed-player-5" name="arena-5-passed-player-5" capture="arena-6-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-5-passed-player-6" name="arena-5-passed-player-6" capture="arena-6-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-5-passed-player-7" name="arena-5-passed-player-7" capture="arena-6-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-5-passed-player-8" name="arena-5-passed-player-8" capture="arena-6-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 6 -->
    <control-point id="arena-6-passed-player-1" name="arena-6-passed-player-1" capture="arena-7-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-6-passed-player-2" name="arena-6-passed-player-2" capture="arena-7-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-6-passed-player-3" name="arena-6-passed-player-3" capture="arena-7-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-6-passed-player-4" name="arena-6-passed-player-4" capture="arena-7-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-6-passed-player-5" name="arena-6-passed-player-5" capture="arena-7-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-6-passed-player-6" name="arena-6-passed-player-6" capture="arena-7-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-6-passed-player-7" name="arena-6-passed-player-7" capture="arena-7-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-6-passed-player-8" name="arena-6-passed-player-8" capture="arena-7-tube-award" player-filter="during-race-phase-player-8" />
    <!-- Arena 7 -->
    <control-point id="arena-7-passed-player-1" name="arena-7-passed-player-1" capture="arena-8-tube-award" player-filter="during-race-phase-player-1" />
    <control-point id="arena-7-passed-player-2" name="arena-7-passed-player-2" capture="arena-8-tube-award" player-filter="during-race-phase-player-2" />
    <control-point id="arena-7-passed-player-3" name="arena-7-passed-player-3" capture="arena-8-tube-award" player-filter="during-race-phase-player-3" />
    <control-point id="arena-7-passed-player-4" name="arena-7-passed-player-4" capture="arena-8-tube-award" player-filter="during-race-phase-player-4" />
    <control-point id="arena-7-passed-player-5" name="arena-7-passed-player-5" capture="arena-8-tube-award" player-filter="during-race-phase-player-5" />
    <control-point id="arena-7-passed-player-6" name="arena-7-passed-player-6" capture="arena-8-tube-award" player-filter="during-race-phase-player-6" />
    <control-point id="arena-7-passed-player-7" name="arena-7-passed-player-7" capture="arena-8-tube-award" player-filter="during-race-phase-player-7" />
    <control-point id="arena-7-passed-player-8" name="arena-7-passed-player-8" capture="arena-8-tube-award" player-filter="during-race-phase-player-8" />
</control-points>
<spawns>
    <default yaw="180" kit="observer-kit">
        <region>
            <point>104.5,76,38.5</point>
        </region>
    </default>
    <!-- Building phase spawns (initial spawns) -->
    <spawn region="arena-1-start"      pitch="90" team="player-1" kit="build-kit-player-1" filter="build-phase" />
    <spawn region="arena-2-start"      pitch="90" team="player-2" kit="build-kit-player-2" filter="build-phase" />
    <spawn region="arena-3-start"      pitch="90" team="player-3" kit="build-kit-player-3" filter="build-phase" />
    <spawn region="arena-4-start"      pitch="90" team="player-4" kit="build-kit-player-4" filter="build-phase" />
    <spawn region="arena-5-start"      pitch="90" team="player-5" kit="build-kit-player-5" filter="build-phase" />
    <spawn region="arena-6-start"      pitch="90" team="player-6" kit="build-kit-player-6" filter="build-phase" />
    <spawn region="arena-7-start"      pitch="90" team="player-7" kit="build-kit-player-7" filter="build-phase" />
    <spawn region="arena-8-start"      pitch="90" team="player-8" kit="build-kit-player-8" filter="build-phase" />
    <!-- Respawns for manual death during testing phase -->
    <spawn region="arena-1-start"      pitch="90" team="player-1" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-2-start"      pitch="90" team="player-2" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-3-start"      pitch="90" team="player-3" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-4-start"      pitch="90" team="player-4" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-5-start"      pitch="90" team="player-5" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-6-start"      pitch="90" team="player-6" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-7-start"      pitch="90" team="player-7" kit="test-phase-kit"     filter="testing-phase" />
    <spawn region="arena-8-start"      pitch="90" team="player-8" kit="test-phase-kit"     filter="testing-phase" />
    <!-- Respawns for manual death during racing phase -->
    <spawn region="arena-0-tube-enter" yaw="90" team="player-1" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-2" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-3" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-4" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-5" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-6" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-7" kit="race-effects"       filter="race-phase" />
    <spawn region="arena-0-tube-enter" yaw="90" team="player-8" kit="race-effects"       filter="race-phase" />
</spawns>
<portals yaw="@180" pitch="@90">
    <!-- Send players to arena if active -->
    <portal region="arena-1-tube-portal" destination="arena-1-start" filter="arena-1-active" sound="false" />
    <portal region="arena-2-tube-portal" destination="arena-2-start" filter="arena-2-active" sound="false" />
    <portal region="arena-3-tube-portal" destination="arena-3-start" filter="arena-3-active" sound="false" />
    <portal region="arena-4-tube-portal" destination="arena-4-start" filter="arena-4-active" sound="false" />
    <portal region="arena-5-tube-portal" destination="arena-5-start" filter="arena-5-active" sound="false" />
    <portal region="arena-6-tube-portal" destination="arena-6-start" filter="arena-6-active" sound="false" />
    <portal region="arena-7-tube-portal" destination="arena-7-start" filter="arena-7-active" sound="false" />
    <portal region="arena-8-tube-portal" destination="arena-8-start" filter="arena-8-active" sound="false" />
    <!-- Send players to next arena if inactive -->
    <portal region="arena-1-tube-portal" destination="arena-2-tube-enter" filter="arena-1-inactive" sound="false" />
    <portal region="arena-2-tube-portal" destination="arena-3-tube-enter" filter="arena-2-inactive" sound="false" />
    <portal region="arena-3-tube-portal" destination="arena-4-tube-enter" filter="arena-3-inactive" sound="false" />
    <portal region="arena-4-tube-portal" destination="arena-5-tube-enter" filter="arena-4-inactive" sound="false" />
    <portal region="arena-5-tube-portal" destination="arena-6-tube-enter" filter="arena-5-inactive" sound="false" />
    <portal region="arena-6-tube-portal" destination="arena-7-tube-enter" filter="arena-6-inactive" sound="false" />
    <portal region="arena-7-tube-portal" destination="arena-8-tube-enter" filter="arena-7-inactive" sound="false" />
    <portal region="arena-8-tube-portal" destination="race-finish"        filter="arena-8-inactive" sound="false" yaw="@180" />
    <!-- Return players to the top of arena tubes if they get stuck -->
    <portal region="arena-1-tube-fail-safe" destination="arena-1-tube-enter" sound="false" />
    <portal region="arena-2-tube-fail-safe" destination="arena-2-tube-enter" sound="false" />
    <portal region="arena-3-tube-fail-safe" destination="arena-3-tube-enter" sound="false" />
    <portal region="arena-4-tube-fail-safe" destination="arena-4-tube-enter" sound="false" />
    <portal region="arena-5-tube-fail-safe" destination="arena-5-tube-enter" sound="false" />
    <portal region="arena-6-tube-fail-safe" destination="arena-6-tube-enter" sound="false" />
    <portal region="arena-7-tube-fail-safe" destination="arena-7-tube-enter" sound="false" />
    <portal region="arena-8-tube-fail-safe" destination="arena-8-tube-enter" sound="false" />
    <!-- Arena testing phase end points to lobby -->
    <portal region="arena-1-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-2-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-3-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-4-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-5-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-6-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-7-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <portal region="arena-8-end" destination="lobby-point" filter="testing-phase" observers="never" yaw="@0"  />
    <!-- Send players to the next arena when completed -->
    <portal region="arena-1-end" destination="arena-2-tube-enter" filter="race-phase" />
    <portal region="arena-2-end" destination="arena-3-tube-enter" filter="race-phase" />
    <portal region="arena-3-end" destination="arena-4-tube-enter" filter="race-phase" />
    <portal region="arena-4-end" destination="arena-5-tube-enter" filter="race-phase" />
    <portal region="arena-5-end" destination="arena-6-tube-enter" filter="race-phase" />
    <portal region="arena-6-end" destination="arena-7-tube-enter" filter="race-phase" />
    <portal region="arena-7-end" destination="arena-8-tube-enter" filter="race-phase" />
    <portal region="arena-8-end" destination="race-finish"        filter="race-phase" yaw="@180" />
    <!-- Return players to current arena after manual death -->
    <portal region="arena-0-tube-portal" destination="arena-1-start" filter="allow-arena-1-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-2-start" filter="allow-arena-2-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-3-start" filter="allow-arena-3-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-4-start" filter="allow-arena-4-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-5-start" filter="allow-arena-5-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-6-start" filter="allow-arena-6-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-7-start" filter="allow-arena-7-enter" sound="false" />
    <portal region="arena-0-tube-portal" destination="arena-8-start" filter="allow-arena-8-enter" sound="false" />
    <!-- Save teammates during testing if test is already complete -->
    <portal forward="save-teammates-1-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-2-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-3-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-4-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-5-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-6-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-7-if-testing-complete" destination="lobby-point" />
    <portal forward="save-teammates-8-if-testing-complete" destination="lobby-point" />
    <!-- Teleport players to arena start points after build phase ends -->
    <portal forward="arena-1-build-phase-end" destination="arena-1-start" observers="never" />
    <portal forward="arena-2-build-phase-end" destination="arena-2-start" observers="never" />
    <portal forward="arena-3-build-phase-end" destination="arena-3-start" observers="never" />
    <portal forward="arena-4-build-phase-end" destination="arena-4-start" observers="never" />
    <portal forward="arena-5-build-phase-end" destination="arena-5-start" observers="never" />
    <portal forward="arena-6-build-phase-end" destination="arena-6-start" observers="never" />
    <portal forward="arena-7-build-phase-end" destination="arena-7-start" observers="never" />
    <portal forward="arena-8-build-phase-end" destination="arena-8-start" observers="never" />
    <!-- Teleport players to waiting area after test phase ends -->
    <portal forward="arena-0-testing-phase-end" destination="lobby-point" observers="never" />
    <!-- Teleport players to arena 1 tube for race start -->
    <portal forward="arena-0-race-started" destination="arena-1-tube-enter" observers="never" />
    <!-- Teleport players back to the arena start during build phase when they sneak while in build net -->
    <portal forward="arena-1-build-net-active" destination="arena-1-start" filter="only-player-1" observers="never" />
    <portal forward="arena-2-build-net-active" destination="arena-2-start" filter="only-player-2" observers="never" />
    <portal forward="arena-3-build-net-active" destination="arena-3-start" filter="only-player-3" observers="never" />
    <portal forward="arena-4-build-net-active" destination="arena-4-start" filter="only-player-4" observers="never" />
    <portal forward="arena-5-build-net-active" destination="arena-5-start" filter="only-player-5" observers="never" />
    <portal forward="arena-6-build-net-active" destination="arena-6-start" filter="only-player-6" observers="never" />
    <portal forward="arena-7-build-net-active" destination="arena-7-start" filter="only-player-7" observers="never" />
    <portal forward="arena-8-build-net-active" destination="arena-8-start" filter="only-player-8" observers="never" />
</portals>
<block-drops>
    <!-- Give player a pickaxe when they punch pickaxe related blocks -->
    <rule punch="true" kit="multitool-pickaxe">
        <filter>
            <all>
                <any>
                    <cause>punch</cause>
                    <cause>mine</cause>
                </any>
                <any>
                    <material>ice</material>
                    <material>stained clay</material>
                    <material>anvil</material>
                    <material>hopper</material>
                    <material>end rod</material>
                    <material>piston base</material>
                    <material>redstone block</material>
                    <material>cobble wall</material>
                    <material>nether fence</material>
                    <material>step</material>
                    <material>sea lantern</material>
                    <material>iron door block</material>
                    <material>iron trapdoor</material>
                    <material>obsidian</material>
                    <material>dispenser</material>
                </any>
                <not>
                    <wearing>
                        <item material="gold nugget" name="`rmagic_multitool.pickaxe" />
                    </wearing>
                </not>
                <filter id="build-phase" />
            </all>
        </filter>
    </rule>
    <!-- Give player an axe when they punch axe related blocks -->
    <rule punch="true" kit="multitool-axe">
        <filter>
            <all>
                <any>
                    <cause>punch</cause>
                    <cause>mine</cause>
                </any>
                <any>
                    <material>spruce fence</material>
                    <material>spruce fence gate</material>
                    <material>spruce wood stairs</material>
                    <material>sign</material>
                    <material>wooden door</material>
                    <material>trap door</material>
                    <material>pumpkin</material>
                </any>
                <not>
                    <wearing>
                        <item material="gold nugget" name="`rmagic_multitool.axe" />
                    </wearing>
                </not>
                <filter id="build-phase" />
            </all>
        </filter>
    </rule>
    <!-- Give player a shovel when they punch shovel related blocks -->
    <rule punch="true" kit="multitool-spade">
        <filter>
            <all>
                <any>
                    <cause>punch</cause>
                    <cause>mine</cause>
                </any>
                <any>
                    <material>snow</material>
                    <material>soul sand</material>
                </any>
                <not>
                    <wearing>
                        <item material="gold nugget" name="`rmagic_multitool.spade" />
                    </wearing>
                </not>
                <filter id="build-phase" />
            </all>
        </filter>
    </rule>
    <!-- Give player a shears when they punch shear related blocks -->
    <rule punch="true" kit="multitool-shears">
        <filter>
            <all>
                <any>
                    <cause>punch</cause>
                    <cause>mine</cause>
                </any>
                <any>
                    <material>wool</material>
                    <material>carpet</material>
                    <material>vine</material>
                    <material>web</material>
                </any>
                <not>
                    <wearing>
                        <item material="gold nugget" name="`rmagic_multitool.shears" />
                    </wearing>
                </not>
                <filter id="build-phase" />
            </all>
        </filter>
    </rule>
</block-drops>
<structures>
    <structure id="preset-puzzle">
        <region>
            <cuboid min="98,3,-2" size="13,67,13" />
        </region>
    </structure>
    <dynamic structure="preset-puzzle" trigger="arena-1-preset-active" location="98,3,-2" />
    <dynamic structure="preset-puzzle" trigger="arena-2-preset-active" location="98,3,-36" />
    <dynamic structure="preset-puzzle" trigger="arena-3-preset-active" location="98,3,-70" />
    <dynamic structure="preset-puzzle" trigger="arena-4-preset-active" location="98,3,-104" />
    <dynamic structure="preset-puzzle" trigger="arena-5-preset-active" location="98,3,-138" />
    <dynamic structure="preset-puzzle" trigger="arena-6-preset-active" location="98,3,-172" />
    <dynamic structure="preset-puzzle" trigger="arena-7-preset-active" location="98,3,-206" />
    <dynamic structure="preset-puzzle" trigger="arena-8-preset-active" location="98,3,-240" />
</structures>
<disabledamage>
    <damage>entity attack</damage>
    <damage>suffocation</damage>
</disabledamage>
<damage>
    <deny>
        <any>
            <region id="arena-ends" />
            <region id="arena-0" />
        </any>
    </deny>
</damage>
<itemremove>
    <item>stained clay</item>
    <item>stained glass</item>
    <item>spruce fence</item>
    <item>skull item</item>
    <item>wood door</item>
    <item>end rod</item>
    <item>web</item>
    <item>potion</item>
    <item>diamond pickaxe</item>
    <item>diamond axe</item>
    <item>diamond spade</item>
    <item>shears</item>
    <item>barrier</item>
</itemremove>
<itemkeep>
    <item>name tag</item>
    <item>leather boots</item>
</itemkeep>
<hunger>
    <depletion>off</depletion>
</hunger>
</map>
